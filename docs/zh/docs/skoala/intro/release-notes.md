# 微服务引擎 Release Notes

本页列出微服务引擎的 Release Notes，便于您了解各版本的演进路径和特性变化。

## 2023-11-07

### V0.28.1

#### 修复

- **修复** 网关服务列表的排序问题
- **修复** 导入网关 API 的多个换行符问题
- **修复** Seata Operator 镜像不支持离线仓库问题
- **修复** 离线发布流程异常的问题

## 2023-10-26

### V0.28.0

#### 新功能

- **新增** 支持网关 API 请求头正则表达式匹配、精准匹配
- **新增** 支持网关 API 批量导入导出
- **新增** 支持托管 Nacos 多版本选择（目前支持 2.0.4、2.1.1、2.2.3 三个版本）
- **新增** 支持 sentinel 控制台密码复杂化
- **新增** 支持托管 Nacos 配置文件定向灰度发布
- **新增** 支持分布式事务（包括 TCC 模式、FMT 模式、SAGA 模式、XA 模式）
- **新增** 支持以 Swagger 标准通过可视化表单界面 导入接口。

#### 修复

- **修复** 托管 Nacos 不同版本支持的问题
- **修复** 网关接口列表请求方法重复的问题
- **修复** Zookeeper 接入注册中心无法接入 TLS 协议实例的问题
- **修复** 网关全局认证开启后域名删除和更新失败的问题
- **修复** 托管 Nacos 命名空间级别 CPU 使用率不正确的问题
- **修复** 托管 Nacos 从 NodePod 模式改为 ClusterIP 模式时 Service 变更不正常的问题
- **修复** Seata 接口验证不正常的问题
- **修复** 接入注册中心切换 Workspace 接入异常的问题
- **修复** 托管 Nacos 相关接口的权限问题
- **修复** 托管 Nacos Grafana 监控面板问题
- **修复** Sentinel Grafana 监控面板问题
- **修复** 整体权限的准确性问题

#### 优化

- **优化** 网关更新逻辑当网关中域名开启了 HTTPS 之后不允许关闭网关层面 HTTPS
- **优化** 审计日志的事件准确性
- **优化** 云原生微服务 WebAssembly 插件逻辑
- **优化** 概览页面的网关健康度查询逻辑（由 Rate 变更为 Increase）
- **优化** Swagger 路径在 URL 中去掉版本信息并支持多版本接口
- **优化** Skoala Init Helm Chart 支持分布式事务控制器（Seata Operator）
- **优化** Skoala Agent 证书
- **优化** 所有 Swagger 中接口描述与详情内容
- **优化** 审计日志格式及自动生成方案
- **优化** 当发布正式版本时，会将 Skoala Helm Chart 发布到正式版镜像仓库的 System 项目中

## 2023-09-01

### V0.27.2

#### 修复

- **修复** 前端更新至 0.18.1 版修复界面问题

### V0.27.1

#### 修复

- **修复** 批量删除时返回详情重复的问题
- **修复** 云原生微服务端口列表中插件信息不能排序的问题
- **修复** 流量泳道列表不正常展示的问题
- **修复** 前端组件的容器名称不统一的问题
- **修复** Sentinel 业务应用监控报表的一些错误

#### 优化

- **优化** 升级 Insight 版本为 0.19.2
- **优化** 升级 Ghippo 版本为 0.20.0

!!! note

    重要：微服务引擎版本大于 `v0.24.2` 版时，针对 `v0.24.2` 及之前版本存在不兼容更新，因为网关涉及开源组件仓库地址变更，
    所以更新前需要手动删除旧有的 `gateway-api-admission-xxxxx` Job，然后进行正常升级更新操作。

## 2023-08-25

### V0.27.0

#### 新功能

- **新增** 支持接入 Consul 注册中心
- **新增** 支持网关实例级别的安全认证配置
- **新增** 支持精确地控制整个集群的流量调用总量
- **新增** 流量泳道

#### 修复

- **修复** 网关服务接入时权限与预定义权限不符的问题
- **修复** 服务治理状态表达不正确的问题
- **修复** 托管 Nacos 配置灰度发布返回异常问题
- **修复** 托管 Nacos 中服务实例列表报错问题
- **修复** 流量泳道服务版本重复的问题
- **修复** 流量泳道中服务列表异常问题
- **修复** 流量泳道服务删除的问题
- **修复** 当错误原因未空时泳道列表空指针异常的问题
- **修复** Skoala-init Chart 表单模式配置不生效的问题

#### 优化

- **优化** 依要求将删除泳道服务从 delete 方法变为 put。
- **优化** 移除多余权限依赖并完善内部权限依赖关系
- **优化** 流量泳道适配界面展示需求
- **优化** 云原生微服务插件接口
- **优化** 添加泳道服务的方式由批量改为单个
- **优化** 前端组件 Deployment 端口由 80 修改为 8080
- **优化** 升级 Ghippo SDK 到 v0.20.0-dev2

!!! note

    重要：微服务引擎版本大于 `v0.24.2` 版时，针对 `v0.24.2` 及之前版本存在不兼容更新，因为网关涉及开源组件仓库地址变更，
    所以更新前需要手动删除旧有的 `gateway-api-admission-xxxxx` Job，然后进行正常升级更新操作。

## 2023-08-03

### v0.26.2

#### 修复

- **修复** `Consul` 注册中心接入时检测不通的问题
- **修复** 网关由于插件应用异常重启问题
- **修复** 网关验证插件配置异常问题
- **修复** `Sentinel` 集群流控规则编辑异常的问题

!!! note

    重要：微服务引擎版本大于 `v0.24.2` 版时，针对 `v0.24.2` 及之前版本存在不兼容更新，因为网关涉及开源组件仓库地址变更，
    所以更新前需要手动删除旧有的 `gateway-api-admission-xxxxx` Job，然后进行正常升级更新操作。

## 2023-07-26

### v0.26.1

#### 修复

- **修复** 修复 Agent 组件版本错误问题

## 2023-07-25

### v0.26.0

#### 新功能

- **新增** 支持给网关运行时 Envoy 注入 Istio Sidecar Envoy 代理
- **新增** 支持 API 级别的全局限流
- **新增** 支持域名级别的全局限流
- **新增** 支持 API 列表批量操作（上线/下线/删除）
- **新增** 支持云原生微服务治理通过插件方式扩展能力，包括：JWT 插件、Auth 插件、全局限流插件等
- **新增** 支持云原生微服务的服务信息详情及端口列表查看

#### 修复

- **修复** Nacos 端口修改不生效的问题
- **修复** Sentinel 集群流控规则保存不生效的问题
- **修复** 删除 Nacos 中非空服务时接口异常的问题
- **修复** 网关监控数据中重复数据的问题
- **修复** 云原生微服务使用插件相关 API 的问题
- **修复** 网关域名命名规则的相关问题
- **修复** 云原生微服务流量泳道的版本错误问题

#### 优化

- **优化** 人大金仓数据库的驱动名由 kb_v8r6 改为 kingbase

## 2023-07-19

### v0.25.0

#### 新功能

- **新增** 将网关运行时的网格注入标识修改被标签方式标记
- **新增** 与中间件关联操作的权限级联选择能力
- **新增** 云原生微服务限流规则详情 API
- **新增** 云原生微服务治理相关 API
- **新增** 为安装托管资源时集群就绪检查添加对应组件版本信息
- **新增** 为各类搜索 API 添加模糊搜索能力

#### 修复

- **修复** 流水线外部镜像扫描地址不对的问题
- **修复** 与中间件关联权限依赖未涵盖目录级别的问题

#### 优化

- **优化** 网关及相关资源变更的连锁校验
- **优化** 网关监听端口由集群 IP 改为容器端口

## 2023-07-06

### v0.24.2

#### 修复

- **修复** 页面体验优化及问题修复

## 2023-07-05

### v0.24.1

#### 修复

- **修复** Skoala-init Chart 表单中版本不是最新的问题
- **修复** 页面体验优化及问题

## 2023-06-30

### v0.24.0

#### 新功能

- **新增** 云原生微服务插件相关 API
- **新增** 与中间件关联操作的权限级联选择能力

#### 修复

- **修复** Insight 集成数据异常的问题
- **修复** 网关状态筛选结果异常的问题

#### 优化

- **优化** 网关及相关资源变更的连锁校验

## 2023-06-26

### v0.23.0

#### 新功能

- **新增** 网关 API 的批量上下线接口
- **新增** 为引擎组件添加增强健康检查的配置
- **新增** 为缓存逻辑添加标签缓存支持
- **新增** 网关创建和更新时网格边车强制注入选项
- **新增** 网关列表按照状态筛选支持
- **新增** 审计日志集成
- **新增** 在持续集成中添加许可检查
- **新增** 将 Chart 中的敏感信息通过 Secret 存储
- **新增** 升级托管 Nacos 版本至 2.2.3 版
- **新增** Sentinel 版本至 0.10.5 版

#### 修复

- **修复** Insight 集成数据指标于原始数据对齐
- **修复** 与 mSpider 模块对接时未继承权限的问题
- **修复** Nacos 实例列表治理开启状态缺失的问题
- **修复** Sentinel 集群流控名称的问题
- **修复** 整体概览查询数据不是按照工作空间统计的问题
- **修复** 网关未开启 HTTPS 但域名可以开启 HTTPS 的问题
- **修复** Skoala-init Chart 表单数据默认值问题

#### 优化

- **优化** Sentinel Grafana 的使用体验和问题
- **优化** 托管资源告警逻辑只展示相关资源告警条目
- **优化** 重构全局管理模块配置结构
- **优化** 托管 Nacos 的信息读取通过 Clusterpedia 完成
- **优化** Insight 对接至 0.17.3 版
- **优化** 数据库中立相关配置的灵活性

## 2023-05-31

### v0.22.2

#### 修复

- **修复** Sentinel 集群流控 API 的问题
- **修复** Sentinel 规则模糊查询 API 的问题

#### 优化

- **优化** 连接数据库的默认值提高容错性

## 2023-05-29

### v0.22.1

#### 修复

- **修复** 插件 CRD 位置不对的问题
- **修复** OpenAPI 发布流程问题

#### 优化

- **优化** 为 Hive 组件的数据库配置设置默认值

## 2023-05-26

### v0.22.0

#### 新功能

- **新增** 托管 Nacos 2.2.x 版本的支持
- **新增** 网关链路功能支持
- **新增** 云原生微服务路径重写 API
- **新增** 云原生微服务超时 API
- **新增** 云原生微服务故障注入 API
- **新增** 云原生微服务重试等 API
- **新增** 云原生微服务使用 WASM 插件功能
- **新增** Skoala-init Chart 添加 JSON Schema
- **新增** OpenAPI 文档发布流程
- **新增** Hive 支持数据库中立

#### 修复

- **修复** 托管 Nacos 相关 API 有几率出现空指针的问题
- **修复** 托管 Nacos 端口展示不正确的问题
- **修复** Grafana 内的 HTTPProxy 拼写错误
- **修复** Nacos 数据库初始化 SQL 脚本问题
- **修复** 网关组件自定义权限对接问题
- **修复** 调用 Ghippo 空指针问题
- **修复** Nacos 服务元数据接口异常问题
- **修复** 更新域名的错误
- **修复** 调用 Kpanda API 频繁的问题
- **修复** 接入 Insight 获取数据不准确的问题
- **修复** WASM 插件查询出现错误
- **修复** 更新 API 路由服务后 API 出现错误
- **修复** Sentinel Token 服务器资源问题
- **修复** Zookeeper 链接未关闭问题

#### 优化

- **优化** Sentinel 监控面板结构和数据逻辑
- **优化** 网关域名管理中移除 virtualhost 自定义资源
- **优化** Sentinel 集群流控的 API 逻辑
- **优化** Ghippo 升级至 0.17.0-rc2
- **优化** 数据库初始化组件 sweet 已于 0.22.0 版废弃，将在 0.23.0 及之后版本彻底移除，从 0.22.0 版开始数据表将自动同步更新，无需人工干预

## 2023-05-07

### v0.21.2

#### 修复

- **修复** Sentinel 监控面板问题
- **修复** 网关被注入网格边车的问题
- **修复** 传统微服务开启网格治理的注册中心地址格式问题
- **修复** 托管注册中心选择中间件实例未按照集群筛选的问题
- **修复** 注册中心统计不正确的问题

#### 优化

- **优化** 更新网关组件到社区最新测试版

## 2023-04-26

### v0.21.1

#### 修复

- **修复** 云原生微服务分页问题

#### 优化

- **优化** 为 Nacos 添加禁用注入 Istio 边车的配置
- **优化** 升级 Insight 版本至 0.16.0 正式版
- **优化** 组件连接数据库重试机制
- **优化** 配合 Istio 治理能力修改 Nacos 的 9848 端口名为 GRPC

## 2023-04-25

### v0.21.0

#### 新功能

- **新增** 网关接入内部及外部地址分离展示
- **新增** 云原生微服务治理能力相关 API
- **新增** 告警消息列表 API
- **新增** 网关使用插件相关 API
- **新增** 网关各类插件的逻辑 API

#### 修复

- **修复** 网关更新时 Envoy 配置不更新的问题
- **修复** 网关只能添加单个端口的问题
- **修复** Insight 集成 JVM 查询的问题
- **修复** 云原生微服务治理 API 的问题
- **修复** Sentinel 规则无法存取的问题
- **修复** 链接不到数据库时某些 API 调用会造成程序崩溃的问题
- **修复** 资源状态 API 的问题
- **修复** 云原生微服务治理 API 时间单位问题
- **修复** 域名相关格式校验问题
- **修复** 插件一些字段命名错误的问题

#### 优化

- **优化** Insight 集成到 0.16.0
- **优化** 部署模板终端服务名称添加模块名前缀
- **优化** virtualhost crd
- **优化** httpproxy crd
- **优化** skoalaplugin crd

## 2023-04-21

### v0.20.0

#### 新功能

- **新增** Sentinel 门户版本
- **新增** 网关域名级别黑白名单支持
- **新增** 原生服务治理列表 API
- **新增** 原生服务治理编辑 API
- **新增** 可观测 JVM 监控集成
- **新增** 网关资源工作负载状态展示
- **新增** 网关负载策略选择配置

#### 修复

- **修复** Contour 镜像版本
- **修复** 自定义角色功能点及 API 映射
- **修复** 网关概览 API 排序和条目

#### 优化

- **优化** 插件中心相关 API
- **优化** 配置文件结构
- **优化** 配置参数由直接读取改为配置包实现
- **优化** 管理组件整体包结构
- **优化** 管理组件
- **优化** Contour 升级到 v1.24.3-ipfilter-tracing
- **优化** Envoy 升级到 v1.25.4

## 2023-04-10

### v0.19.4

#### 修复

- **修复** 托管 Nacos 的启动问题

## 2023-04-10

### v0.19.3

#### 修复

- **修复** 前端问题

## 2023-04-04

### v0.19.2

#### 修复

- **修复** Nacos 及 Sentinel 默认验证账号问题
- **修复** 概览网关 API 排序问题

## 2023-04-04

### v0.19.1

#### 修复

- **修复** CVE-2022-31045 漏洞
- **修复** 插件中心 API 问题
- **修复** 网关重启的问题
- **修复** 插件更新时版本不能成功更新的问题
- **修复** Nacos 及 Sentinel 默认验证账号问题
- **修复** 概览内微服务网关网关 API 排序问题
- **修复** Nacos 支持版本回滚至 2.0.4

## 2023-03-24

### v0.19.0

#### 新功能

- **新增** 自定义权限点及 API 的实现
- **新增** 注册中心概览相关 API
- **新增** 网关黑白名单相关 API
- **新增** 概览中网关健康度相关 API
- **新增** Nacos 支持版本至 2.1.2
- **新增** 获取 Nacos 及网关版本信息 API
- **新增** 概览中注册配置中心统计收集器
- **新增** 概览中注册配置中心统计 API
- **新增** 云原生微服务服务列表 API
- **新增** 云原生微服务服务导入相关 API
- **新增** 插件中心自定义资源设计
- **新增** 插件中心插件管理相关 API
- **新增** 网关前置流量拦截配置 API
- **新增** 级联资源操作添加事务 (类似) 机制处理包
- **新增** 资源重启功能

#### 修复

- **修复** Nacos Operator 中初始化 Nacos 的数据库脚本问题
- **修复** Sentinel 相关数据概览 API 的问题
- **修复** 网关相关数据的概览 API 的问题
- **修复** 网关生命周期管理减少网关异常重启问题
- **修复** 概览 API 路径大小写问题
- **修复** Nacos 2.1.2 无法创建集群的问题
- **修复** 网关前置流量拦截修改不生效的问题
- **修复** 网关黑白名单 API 的问题
- **修复** Nacos GRPC 端口名字对集成 Istio 产生的问题
- **修复** 每日构建中的外部镜像安全扫描

#### 优化

- **优化** CI 流程并简化不必要的任务
- **优化** 全部资源的更新操作都采用 retry 机制
- **优化** 网关相关功能重构

## 2023-02-25

### v0.18.0

#### 新功能

- **新增** 添加注册中心配置中心分离 API
- **新增** 添加概览相关逻辑及 API

#### 修复

- **修复** gateway-api 镜像版本问题
- **修复** 负载均衡模式网关的 IP 池加载问题
- **修复** 健康检查相关问题

## 2023-02-22

### v0.17.1

#### 新功能

- **新增** 网关 NodePort 支持
- **新增** 网关 LoadBalancer 支持
- **新增** Sentinel 规则统计 API
- **新增** Sentinel 治理的服务列表 API
- **新增** 网关 API 的 Cookie 重写策略
- **新增** 概览数据定时任务
- **新增** 定时收集异常 Sentinel 任务
- **新增** Sentinel 集群流控详情 API
- **新增** 网关接入服务列表端口选择
- **新增** 网关服务健康检查策略
- **新增** 网关 API 中对健康策略的支持
- **新增** Sentinel 统计相关 API
- **新增** 支持 chart 离线化的 CI 流程
- **新增** 在每日构建中增加外部镜像安全扫描能力
- **新增** 发布自动更新 chart 中镜像版本

#### 修复

- **修复** Nacos Namespace 创建异常的问题
- **修复** Nacos 持久化存储修改异常的问题
- **修复** Nacos 生命周期管理资源校验问题
- **修复** 网关监控面板数据展示问题
- **修复** Ghippo 链接 GRPC 地址缺失问题
- **修复** Sentinel 获取集群流控 API 的问题
- **修复** 托管 Nacos 资源状态不更新的问题
- **修复** Sentinel 适配 Nacos public 字符串问题
- **修复** Sentinel 获取资源 API 没有聚合不同实例问题
- **修复** Sentinel 系统规则不生效问题
- **修复** 网关服务注册中心类型分页错误的问题
- **修复** 创建服务端口错误的问题
- **修复** 数据库初始化组建的问题
- **修复** 使用 Helm 命令替代 Argocd 部署 Alpha 环境
- **修复** 基础镜像 CVE 问题并升级至 3.17.2
- **修复** 发布过程 Chart 更新问题

#### 优化

- **优化** 升级 gateway-api 到 v0.6.0
- **优化** 待更新资源获取由 clusterpedia 改为 client-go
- **优化** Sentinel 应用监控模板
- **优化** 将离线 chart 构建 CI 步骤独立
- **优化** Contour 升级到 v1.24.1
- **优化** envoy 升级到 v1.25.1
- **优化** 通过 Chart 能力使 Skoala Init 安装时固定命名空间

## 2022-12-30

### v0.16.1

#### 修复

- **修复** 构建镜像时重复创建 builder 的问题

#### 优化

- **优化** Sentinel 应用监控面板细节

## 2022-12-29

### v0.16.0

#### 修复

- **修复** Sentinel 调用具备认证开启 Nacos 接口的问题
- **修复** nacos-operator 频繁修改服务资源的问题

#### 优化

- **优化** 添加 Sentinel 服务的 Grafana 监控面板
- **优化** 升级 Insight 为最新版本支持通过集群名查询监控数据

## 2022-12-28

### v0.15.2

#### 新功能

- **新增** 网关 API 对于认证服务器的支持
- **新增** 托管注册中心服务接入 API
- **新增** Sentinel 集群流控相关 API

#### 修复

- **修复** Sentinel 规则拼接错误的问题
- **修复** Sentinel 仪表盘名称的问题
- **修复** 管理组件 Chart 对于生产换环境的 Service IP 问题
- **修复** Nacos 控制器处理逻辑的问题
- **修复** 与集群管理集成的 egress 地址问题

#### 优化

- **优化** 托管 Nacos 监控仪表盘问题
- **优化** nacos-operator 数据库初始化的文件获取地址
- **优化** 更新 Sentinel 镜像至 v0.6.0

## 2022-12-22

### v0.14.0

#### 新功能

- **新增** Init Chart 所需镜像的离线支持
- **新增** 获取托管 Nacos 的令牌

#### 修复

- **修复** Skoala Chart 中 Values 命名问题
- **修复** CI 流程中的镜像问题

#### 优化

- **优化** 设置默认日志输出到控制台
- **优化** 升级 nacos-operator 到社区版本
- **优化** 更新 Nacos 自定义资源的认证开启支持
- **优化** 设置默认组件日志级别

## 2022-12-21

### v0.13.0

#### 新功能

- **新增** 对接中间件 MySQL 和 Redis 的相关 API
- **新增** 网关 JWT 验证支持的 API
- **新增** 网关域名校验逻辑
- **新增** Sentinel 资源列表 API
- **新增** 网关查询注册中心服务的接口
- **新增** 版本发布后推送 Init Chart 至 addon 仓库
- **新增** 版本发布时完成 gitlab release 操作
- **新增** 动态更改日志级别

#### 修复

- **修复** 全局限流规则更新时不生效的问题
- **修复** Envoy Log Level 未设置问题
- **修复** 更新网关时异常未判断的问题
- **修复** 托管 Nacos 的数据库初始化问题

#### 优化

- **优化** 注册中心列表按更新时间降序排列
- **优化** 统一网关 JWT 相关的字段名称
- **优化** 网关域名列表增加是否开启 JWT 的字段
- **优化** Sentinel 服务名连接符的逻辑
- **优化** 升级 Contour 到 1.23 版
- **优化** 升级 Envoy 到 1.24 版
- **优化** 升级 k8s.io/相关组件到 0.25 版
- **优化** 将 go-replayers 组件回归社区版本
- **优化** 将 go-helm-client 组件回归社区版本
- **优化** 升级 Contour 到 1.23.1 版
- **优化** 修改 Agent 组件为强制不注入网格边车
- **优化** 将 Nacos 镜像默认配置回归社区版本
- **优化** 移除 Nacos 镜像相关 CI 流程

## 2022-12-13

### v0.12.2

#### 新功能

- **新增** 添加 Sentinel 自身监控的 Grafana 模板支持
- **新增** 添加自定义配置网关索引的配置信息

#### 修复

- **修复**  微服务集成可观测组件的状态问题
- **修复** 注册中心开启网格插件能力的治理状态问题
- **修复** 网关日志索引问题
- **修复** 前置依赖检查接口的问题
- **修复** Sentinel 与 Nacos 默认命名空间匹配的逻辑问题
- **修复** 连接容器管理模块的端口异常情况的逻辑
