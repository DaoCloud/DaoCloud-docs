# æ‹¨æµ‹

æ‹¨æµ‹ï¼ˆProbeï¼‰æŒ‡çš„æ˜¯åŸºäºé»‘ç›’ç›‘æ§ï¼Œå®šæœŸé€šè¿‡ HTTPã€TCP ç­‰æ–¹å¼å¯¹ç›®æ ‡è¿›è¡Œè¿é€šæ€§æµ‹è¯•ï¼Œå¿«é€Ÿå‘ç°æ­£åœ¨å‘ç”Ÿçš„æ•…éšœã€‚

Insight åŸºäº [Prometheus Blackbox Exporter](https://github.com/prometheus/blackbox_exporter)
å·¥å…·é€šè¿‡ HTTPã€HTTPSã€DNSã€TCP å’Œ ICMP ç­‰åè®®ï¼Œå¯¹ç½‘ç»œè¿›è¡Œæ¢æµ‹å¹¶è¿”å›æ¢æµ‹ç»“æœä»¥ä¾¿äº†è§£ç½‘ç»œçŠ¶æ€ã€‚

## å‰ææ¡ä»¶

ç›®æ ‡é›†ç¾¤ä¸­[å·²æˆåŠŸéƒ¨ç½² insight-agent](../../quickstart/install/install-agent.md)ï¼Œä¸”å¤„äº __è¿è¡Œä¸­__ çŠ¶æ€ã€‚

## æŸ¥çœ‹æ‹¨æµ‹ä»»åŠ¡

1. è¿›å…¥ __å¯è§‚æµ‹æ€§__ äº§å“æ¨¡å—ï¼›
2. åœ¨å·¦è¾¹å¯¼èˆªæ é€‰æ‹© __åŸºç¡€è®¾æ–½__ -> __æ‹¨æµ‹__ ã€‚

    - ç‚¹å‡»è¡¨æ ¼ä¸­çš„é›†ç¾¤æˆ–å‘½åç©ºé—´ä¸‹æ‹‰æ¡†ï¼Œå¯åˆ‡æ¢é›†ç¾¤å’Œå‘½åç©ºé—´
    - ä½ å¯ä»¥ç‚¹å‡»å³ä¾§çš„ âš™ï¸ ä¿®æ”¹æ˜¾ç¤ºçš„åˆ—ï¼Œé»˜è®¤ä¸ºæ‹¨æµ‹åç§°ã€æ¢æµ‹æ–¹å¼ã€æ¢æµ‹ç›®æ ‡ã€è¿é€šçŠ¶æ€ã€åˆ›å»ºæ—¶é—´
    - è¿é€šçŠ¶æ€æœ‰ 3 ç§ï¼š
        - æ­£å¸¸ï¼šProbe æˆåŠŸè¿æ¥åˆ°äº†ç›®æ ‡ï¼Œç›®æ ‡è¿”å›äº†é¢„æœŸçš„å“åº”
        - å¼‚å¸¸ï¼šProbe æ— æ³•è¿æ¥åˆ°ç›®æ ‡ï¼Œæˆ–ç›®æ ‡æ²¡æœ‰è¿”å›é¢„æœŸçš„å“åº”
        - Pendingï¼šProbe æ­£åœ¨å°è¯•è¿æ¥ç›®æ ‡
    - ä½ å¯ä»¥åœ¨ ğŸ” æœç´¢æ¡†ä¸­é”®å…¥åç§°ï¼Œæ¨¡ç³Šæœç´¢æŸäº›æ‹¨æµ‹ä»»åŠ¡

    ![probe](https://docs.daocloud.io/daocloud-docs-images/docs/zh/docs/insight/images/probe00.png){ width=1000px}

## åˆ›å»ºæ‹¨æµ‹ä»»åŠ¡

1. ç‚¹å‡» __åˆ›å»ºæ‹¨æµ‹ä»»åŠ¡__ ã€‚
2. å¡«å†™åŸºæœ¬ä¿¡æ¯åç‚¹å‡» __ä¸‹ä¸€æ­¥__ 

    - é›†ç¾¤ï¼šé€‰æ‹©éœ€è¦æ‹¨æµ‹çš„é›†ç¾¤
    - å‘½åç©ºé—´ï¼šæ‹¨æµ‹æ‰€åœ¨çš„å‘½åç©ºé—´

    ![probe](https://docs.daocloud.io/daocloud-docs-images/docs/zh/docs/insight/images/probe01.png){ width=1000px}

3. é…ç½®æ¢æµ‹å‚æ•°ã€‚

    - Blackbox å®ä¾‹ï¼šé€‰æ‹©è´Ÿè´£æ¢æµ‹çš„ blackbox å®ä¾‹
    - æ¢æµ‹æ–¹å¼ï¼š
        - HTTPï¼šé€šè¿‡å‘é€ HTTP æˆ– HTTPS è¯·æ±‚åˆ°ç›®æ ‡ URLï¼Œæ£€æµ‹å…¶è¿é€šæ€§å’Œå“åº”æ—¶é—´ï¼Œè¿™å¯ä»¥ç”¨äºç›‘æµ‹ç½‘ç«™æˆ– Web åº”ç”¨çš„å¯ç”¨æ€§å’Œæ€§èƒ½
        - TCPï¼šé€šè¿‡å»ºç«‹åˆ°ç›®æ ‡ä¸»æœºå’Œç«¯å£çš„ TCP è¿æ¥ï¼Œæ£€æµ‹å…¶è¿é€šæ€§å’Œå“åº”æ—¶é—´ã€‚è¿™å¯ä»¥ç”¨äºç›‘æµ‹åŸºäº TCP çš„æœåŠ¡ï¼Œå¦‚ Web æœåŠ¡å™¨ã€æ•°æ®åº“æœåŠ¡å™¨ç­‰
        - å…¶ä»–ï¼šæ”¯æŒé€šè¿‡é…ç½® ConfigMap è‡ªå®šä¹‰æ¢æµ‹æ–¹å¼ï¼Œå¯å‚è€ƒ[è‡ªå®šä¹‰æ‹¨æµ‹æ–¹å¼](../collection-manag/probe-module.md)
    - æ¢æµ‹ç›®æ ‡ï¼šæ¢æµ‹çš„ç›®æ ‡åœ°å€ï¼Œæ”¯æŒåŸŸåæˆ– IP åœ°å€ç­‰
    - æ ‡ç­¾ï¼šè‡ªå®šä¹‰æ ‡ç­¾ï¼Œè¯¥æ ‡ç­¾ä¼šè‡ªåŠ¨æ·»åŠ åˆ° Prometheus çš„ Label ä¸­
    - æ¢æµ‹é—´éš”ï¼šæ¢æµ‹é—´éš”æ—¶é—´
    - æ¢æµ‹è¶…æ—¶ï¼šæ¢æµ‹ç›®æ ‡æ—¶çš„æœ€é•¿ç­‰å¾…æ—¶é—´

    ![probe](https://docs.daocloud.io/daocloud-docs-images/docs/zh/docs/insight/images/probe02.png){ width=1000px}

4. é…ç½®å®Œæˆåï¼Œç‚¹å‡» __ç¡®å®š__ å³å¯å®Œæˆåˆ›å»ºã€‚

!!! warning

    æ‹¨æµ‹ä»»åŠ¡åˆ›å»ºå®Œæˆåï¼Œéœ€è¦å¤§æ¦‚ 3 åˆ†é’Ÿçš„æ—¶é—´æ¥åŒæ­¥é…ç½®ã€‚åœ¨æ­¤æœŸé—´ï¼Œä¸ä¼šè¿›è¡Œæ¢æµ‹ï¼Œæ— æ³•æŸ¥çœ‹æ¢æµ‹ç»“æœã€‚

## ç¼–è¾‘æ‹¨æµ‹ä»»åŠ¡

ç‚¹å‡»åˆ—è¡¨å³ä¾§çš„ __â‹®__ -> __ç¼–è¾‘__ ï¼Œå®Œæˆç¼–è¾‘åç‚¹å‡» __ç¡®å®š__ ã€‚

![probe](https://docs.daocloud.io/daocloud-docs-images/docs/zh/docs/insight/images/probe04.png){ width=1000px}

## æŸ¥çœ‹ç›‘æ§é¢æ¿

ç‚¹å‡»åˆ—è¡¨å³ä¾§çš„ __â‹®__ -> __æŸ¥çœ‹ç›‘æ§é¢æ¿__ ï¼Œè·³è½¬åˆ° Grafana æ‹¨æµ‹ä»»åŠ¡æ¦‚è§ˆé¡µé¢ï¼Œä»¥å›¾è¡¨æ–¹å¼æ˜¾ç¤ºé’ˆå¯¹ç½‘ç»œçŠ¶å†µçš„æ¢æµ‹ç»“æœã€‚

![probe](https://docs.daocloud.io/daocloud-docs-images/docs/zh/docs/insight/images/probe03.png){ width=1000px}

| æŒ‡æ ‡åç§° | æè¿° |
| -- | -- |
| Current Status Response | è¡¨ç¤º HTTP æ¢æµ‹è¯·æ±‚çš„å“åº”çŠ¶æ€ç ã€‚|
| Ping Status | è¡¨ç¤ºæ¢æµ‹è¯·æ±‚æ˜¯å¦æˆåŠŸã€‚1 è¡¨ç¤ºæ¢æµ‹è¯·æ±‚æˆåŠŸï¼Œ0 è¡¨ç¤ºæ¢æµ‹è¯·æ±‚å¤±è´¥ã€‚ |
| IP Protocol | è¡¨ç¤ºæ¢æµ‹è¯·æ±‚ä½¿ç”¨çš„ IP åè®®ç‰ˆæœ¬ã€‚ |
| SSL Expiry | è¡¨ç¤º SSL/TLS è¯ä¹¦çš„æœ€æ—©åˆ°æœŸæ—¶é—´ã€‚ |
| DNS Response (Latency) | è¡¨ç¤ºæ•´ä¸ªæ¢æµ‹è¿‡ç¨‹çš„æŒç»­æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ã€‚ |
| HTTP Duration | è¡¨ç¤ºä»å‘é€è¯·æ±‚åˆ°æ¥æ”¶åˆ°å®Œæ•´å“åº”çš„æ•´ä¸ªè¿‡ç¨‹çš„æ—¶é—´ã€‚|

## åˆ é™¤æ‹¨æµ‹ä»»åŠ¡

ç‚¹å‡»åˆ—è¡¨å³ä¾§çš„ __â‹®__ -> __åˆ é™¤__ ï¼Œç¡®è®¤æ— è¯¯åç‚¹å‡» __ç¡®å®š__ ã€‚

![probe](https://docs.daocloud.io/daocloud-docs-images/docs/zh/docs/insight/images/probe05.png){ width=1000px}

!!! caution

    åˆ é™¤æ“ä½œä¸å¯æ¢å¤ï¼Œè¯·è°¨æ…æ“ä½œã€‚
