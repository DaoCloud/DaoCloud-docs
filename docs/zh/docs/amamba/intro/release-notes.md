# 应用工作台 Release Notes

本页列出应用工作台的 Release Notes，便于您了解各版本的演进路径和特性变化。

## 2023-11-30

### v0.22.0

#### 新功能

- **新增** 敏感操作添加到审计日志
- **新增** 流水线支持添加全局环境变量
- **新增** 流水线支持部署应用、更新应用镜像两个步骤
- **新增** 支持部署 SonarQube 工具链

#### 优化

- **优化** API 支持搜索 Jenkins 的 node label
- **优化** API 支持集成跨集群的 Jenkins
- **优化** 流水线模板增加参数校验
- **优化** 各个组件服务暴露了 golang 本身的指标和 pprof 页面
- **优化** API 支持原生应用版本回滚
- **优化** form git/jar 创建应用时采用 serviceAccountToken 的方式部署应用，避免权限逃逸

#### 修复

- **修复** 当目标集群没有安装 Istio 时原生应用 **导出应用模板** 和 **创建版本** 报错
- **修复** ArgoCD 安装在指定命名空间时获取 git/tag 失败
- **修复** 流水线模板保存后内容变更的问题

## 2023-10-31

### v0.21.0

#### 新功能

- **新增** 支持创建 OLM 应用
- **新增** 支持编辑 OLM 应用 YAML
- **新增** 支持删除 OLM 应用
- **新增** 支持基于 Istio 的请求特征发布
- **新增** 原生应用支持版本管理（增删改查）
- **新增** 原生应用支持导出模板

#### 优化

- **优化** API 支持返回 argocd/kubevela 组件是否安装
- **优化** 支持搜索 git 远程分支和 tag
- **优化** 多分支流水线正则表达式输入时进行校验
- **优化** 提供 feature gate 状态接口，未开启的时候前端不展示
- **优化** 增加了创建 kube-app-manager 的接口
- **优化** 升级 argo-rollout 的 chart 版本到 v2.32.0

#### 修复

- **修复** 修复了检查 kangaroo 的 project 绑定关系报错的 bug
- **修复** 创建 OAM 应用时对应控制面 ns 相关 bug
- **修复** kubernetes cd 插件导致的 form git/jar deploy 错误
- **修复** 不在审核名单中的用户也可以审核流水线的问题
- **修复** 同步流水线导致的流水线配置错误
- **修复** 更新 rollout 时类型会被重置的问题

## 2023-08-31

### v0.20.0

#### 新功能

- **新增** 集成 GitLab 的时候使用 access token 的方式
- **新增** 增加了原生应用的状态字段
- **新增** API 新增了对接 kolm 的接口
- **新增** API 多云应用相关的 CURD 接口
- **新增** 在流水线里添加 trigger，同时自动在 GitLab 里添加 Webhook，并能通过相关事件触发流水线

#### 优化

- **优化** 获取 SonaQube 的扫描结果的时候，不与对应的运行记录绑定，从最新的运行记录获取
- **优化** 流水线最近记录与流水线上次运行记录不一致的问题
- **优化** 监听绑定到 workspace 的资源处理逻辑
- **优化** KubeVela 连接不上时的报错提示信息

#### 修复

- **修复** 创建控制面集群的命名空间时，Global 集群设置了资源限额导致创建失败的问题
- **修复** 控制面集群的命名空间可以绑定到多个工作空间的问题
- **修复** 创建控制面集群的命名空间时，如果 ns 处于被删除状态依旧创建成功的问题
- **修复** 判断多分支流水线配置是否相同错误
- **修复** 链路查询时没有 dbName 的问题

## 2023-07-31

### v0.19.2

#### 新功能

- **新增** Issues 界面列表支持跳转到 Jira 查看详情
- **新增** 集群增加了状态标识
- **新增** OAM 应用支持编辑 YAML、添加组件、编辑组件、编辑运维特征等功能
- **新增** 支持流水线根据最近时间运行时间排序
- **新增** 流水线支持 Sonarqube 配置、代码质量结果步骤
- **新增** 工具链支持 Sonarqube 实例的集成
- **新增** 向导基于 git、jar、容器镜像创建应用时默认绑定原生应用

#### 优化

- **优化** 优化集成 gitlab 时到 jenkins 凭证的步骤
- **优化** 管理员视角下列出绑定了工作空间的 sonarqube 的绑定时间以及增加了分野
- **优化** 修复了 apiserver 的缓存不过期的问题

## 2022-06-30

### v0.18.1

#### 新功能

- **新增** 流水线权限支持了运行流水线权限点
- **新增** 支持对原生应用的更新、删除、拓扑
- **新增** 流水线支持选择集成的 gitlab 仓库的项目
- **新增** 支持 OAM 应用的创建、详情等基础功能
- **新增** 安装 Kubevela 开源组件
- **新增** 支持工具链资源的自动同步和手动同步，同时暴露对应的 metric 指标
- **新增** 流水线模板添加了版本信息
- **新增** 支持创建原生应用，查看原生应用的资源信息
- **新增** 新增集群范围的 nginx ingress-class 的检查

#### 修复

- **修复** 目标集群没有安装原生应用的 CRD 时，原生应用列表页会报错
- **修复** 更新流水线凭证时，当不返回密码信息的时候，没有修改任何值导致返回 null 的修复
- **修复** 同步导致的多分支流水线的“孤儿策略”为空的时候显示为 -1 的问题

#### 优化

- **优化** API 优化了流水线异常场景的处理
- **优化** API 为集群添加一个状态字段显示集群运行时状态
- **优化** 硬编码优化，支持部署到不同的 namespace 中
- **优化** 当集成 gitlab 的时候，返回 gitlab 的 address
- **优化** 基于 Jenkinsfile 的流水线和多分支流水线集成 gitlab 的时候返回 toolchainID

## 2023-6-15

### v0.17.4

#### 修复

- **修复** 修复了金丝雀发布任务中操作异常问题

## 2022-05-31

### v0.17.3

#### 新功能

- **新增** API 支持通过代码选择器来选择集成的代码仓库
- **新增** 支持基于 nginx-ingress 的灰度发布策略
- **新增** API 支持应用的资源拓扑
- **新增** API 统一了凭证
- **新增** 流水线模板添加了版本信息
- **新增** 支持创建原生应用，查看原生应用的资源信息

#### 修复

- **修复** 基于容器镜像中容器不支持下划线的问题
- **修复** 蓝绿发布的副本数报错的问题
- **修复** 同步导致的多分支流水线的“孤儿策略”为空的时候显示为-1 的问题

#### 优化

- **优化** jira-provider 的 http-client 增加了重试功能。处理流水线事件的处理速度
- **优化** 处理流水线事件的处理速度
- **优化** 重构了 from-git 和 from-jar 的流水线模板
- **优化** 向 Jenkins 请求的 url， 普通流水线的和多分支统一 url

## 2022-04-30

### v0.16.1

#### 新功能

- **新增** 创建应用时独立出可观测性相关的配置，包括指标监测，链路追踪和 JVM 监控
- **新增** 集成工具链支持 Jenkins
- **新增** 支持多分支流水线的创建及管理
- **新增** 支持管理员视角下的工具链集成功能
- **新增** API 支持了蓝绿发布，包括创建，删除，回滚，升级，详情等

#### 修复

- **修复** 管理员绑定项目到指定工作空间下下，获取关联工具链实例详情时，无法正常获取的 bug
- **修复** 基于 from-jar 和 from-git 创建应用过程中出现 IMAGE_TAG 为空的时候，在对应的模板文件里里设置为 latest

#### 优化

- **优化** 统一整合工具链接口

## 2022-03-31

### v0.15.1

#### 新功能

- **新增** 容器配置支持更多选项(生命周期，环境变量和数据存储)
- **新增** jira 工具链集成接口，包括 jira 实例的 CRUD 和实例项目的列表
- **新增** 缺陷列表支持模糊查询、类型、状态、优先级的查询
- **新增** 针对 ghippo 的 smtp 配置的 list/watch 机制，支持 jenkins 的邮件通知功能
- **新增** 允许创建自定义角色
- **新增** API 支持工具链集成添加 jenkins 类型，添加获取 jenkins 列表和详情
- **新增** API 支持多分支流水线
- **新增** 流水线运行记录详情支持查看测试报告
- **新增** 流水线新增 SVN 、Junit 收集测试报告步骤
- **新增** 支持通过模板创建流水线
- **新增** 支持创建自定义流水线模板

#### 优化

**优化** 调整 jenkins 的 cpu，内存参数

#### 修复

**修复** 修复了如果 page 小于 0，则无法搜索到对应工具链数据的问题，添加了部分可供前端展示的字段

## 2022-02-22

### v0.14.0

#### 新功能

- **新增** API 支持使用内置模板创建流水线
- **新增** API 支持自定义模板的创建、更新、删除
- **新增** apiserver、devopserver 支持访问 https 协议的 Jenkins
- **新增** event-proxy 组件支持 Jenkins 的事件持久化
- **新增** 访问 Jenkins 时支持重试和限流

#### 优化

**优化** 优化了重新运行某条流水线失败时的提示语

#### 修复

- **修复** 修复了凭证在数据库和 Jenkins 里不一致时的问题
- **修复** 修复了创建灰度发布时流量比例大于 100 也能创建成功的问题

## 2022-01-30

### v0.13.0

#### 新功能

- **新增** 支持级联删除，可以根据实际情况选择需要删除的资源
- **新增** 灰度发布支持编辑 YAML 功能
- **新增** 部署应用工作台的 Chart 包中移除了 Jenkins，支持使用单独的 Helm Chart 安装 Jenkins

#### 优化

**优化** 制品报告下载，不在 apiserver 中全部缓存，采用 io 分块的模式部分缓存转发

#### 修复

**修复** 修复了持续部署中添加私有仓库报错问题

## 2022-12-30

### v0.12.0

#### 新功能

- **新增** 创建应用时支持同时开启传统微服务和服务网格
- **新增** 查询灰度发布支持模糊查询，查询持续部署支持模糊查询和根据状态检索，
  查询 gitops 仓库支持模糊查询和状态检索
- **新增** 添加根据 GVR 获取 jso 数据的接口
- **新增** 添加获取 helm 信息的接口，可以通过 argocd 部署 helm chart
- **新增** Jenkins 配置文件的热加载以及 syncer 配置文件的热加载
- **新增** ListRegistry 接口返回值新增 Nacos 是否需要认证字段
- **新增** 流水线制品报告列表接口和下载制品报告接口
- **新增** 流水线步骤日志支持获取全量日志
- **新增** 查询插件信息接口添加了缓存
- **新增** 直接复制已有的流水线来生成新的流水线
- **新增** 开启微服务时接入指标监控提供差异化配置，可自定义路径
- **新增** Jenkins 的 trace 的对接
- **新增** ListWorkload 接口返回值添加应用关联资源

#### 修复

- **修复** 重新运行流水线，概率性的 panic 的修复
- **修复** 创建微服务时链路追踪中用到的 instrumentation 镜像离线化问题
- **修复** 灰度发布的监控分析失败
- **修复** 支持设置 argo-rollouts controller replicas

## 2022-12-18

### v0.11.0

#### 新功能

- **新增** Ghippo 和 Skoala 的 trace 对接，Ghippo 自身只支持部分 api 的 trace
- **新增** helm 包离线情况下的镜像检查的流水线
- **新增** 针对添加迁移 jenkins 后，credential 失效的问题，添加解决方案
- **新增** 凭证列表支持按名称模糊搜索

#### 优化

- **优化** 通过调整 jvm 参数，降低 jenkins 在没有工作负载的情况下的内存占用
- **优化** gitops 模块创建仓库时增加对仓库可连接性的判断
- **优化** 实时同步流水线运行状态等信息导致 jenkins 压力过大，改成懒加载的方式
- **优化** 优化了 api 发版流程，支持单独发版

#### 修复

- **修复** 启用微服务的情况下如果创建失败则无限制进行回滚的问题
- **修复** 当集群的 kubeconfig 变更导致的 argocd 应用部署/删除失败，
  以及 jenkins 中 credential 失效的问题

## 2022-11-30

### v0.10.0

#### 新功能

- **新增** 新增了 gitops 中的仓库功能，支持导入、删除
- **新增** 新增了 gitops 应用的同步功能

#### 优化

**优化** 优化了应用接入服务网格流程

#### 修复

- **修复** 修复了 admin 用户未对部署目标（cluster/namespace）鉴权的问题
- **修复** 修复了 gitops 应用创建时间、同步开始时间和同步结束时间为 **Invalida date** 的错误
- **修复** 修复了获取 nacos 注册中心列表数据的错误
- **修复** 修复了列出工作负载接口通过名称排序报错
- **修复** 修复了集群解绑并重新绑定后，在 ArgoCD 中 destionation 中的 cluster 和 namespace 丢失的问题
- **修复** 修复了在更新 namespace 的 label 导致 namespace 和 workspace 绑定关系丢失的问题
- **修复** 修复了在完成流水线后，同步 jenkins 的 config 到数据库时，trigger 转换的错误
- **修复** 修复了因为集群的 kubeconfig 变更导致的 ArgoCD cluster 和 jenkins 中
  kubeconfig 类型的 credential 不同步的问题
- **修复** 修复了仓库列表出现的无序和分页问题
- **修复** 修复了 from-jar 上传超过 32M 文件失败的问题

## 2022-11-18

### v0.9.0

#### 新功能

- **新增** jenkins-agent 镜像持续发布
- **新增** 添加了使用中间件的数据库的选项
- **升级** jenkins 从 2.319.1 升级到 2.346.2,kubernetes plugin 升级到 3734.v562b_b_a_627ea_c，
  相关的 plugins 也作了升级

#### 优化

- **优化** 获取 rollout 镜像列表，应用组列表，原生应用列表等性能优化
- **优化** from-jar 用到的 image 不再写死在源代码中，通过 env 的方式传递，并保证安装器能正确获取

#### 修复

- **修复** rollout 在不同 workspace 下无法区分的问题
- **修复** gitops 模块未鉴权的问题
- **修复** 偶现的 pipeline step 状态不正确的问题
- **修复** 获取 helmchart 的 description 为空的问题
- **修复** 创建 namespace 没有校验 storage 的问题
- **修复** list argocd repository 出现的无序和分页问题的修复
- **修复** from-jar 上传超过 32M 文件失败的问题的修复
- **修复** 获取 pipeline 日志的时候如果日志量过大则无法获取全量日志的问题
