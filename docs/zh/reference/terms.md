# 术语表

本页介绍 DEC 5.0 各个模块中的常见术语。

- 保护阈值

    阈值是一个 0 到 1 之间的浮点数。当健康实例数占总服务实例数的比例小于该值时，无论实例是否健康，都会将这个实例返回给客户端。这样可以防止流量压力把健康实例压垮并形成雪崩效应。

- 自定义资源定义 (CRD)

    自定义资源定义是默认的 Kubernetes API 扩展，服务网格使用 Kubernetes CRD API 来进行配置。

- Data ID

    Nacos 中某个配置集的 ID。配置集是一组配置项的集合，通常表现为一个配置文件，其中包括系统各方面的配置。

- Envoy
  
    Envoy 是在服务网格里使用的高性能代理，用于为所有服务网格里的服务调度进出的流量。

- 服务（Service）

    使用服务名称标识一组具有关联行为的服务服务网格，并使用这些名称应用服务网格策略（例如负载均衡和路由）。服务通常由一个或多个服务 Endpoint 实现，并且或许包含多个服务版本。

- 服务发现

    用于 Kubernetes 环境的服务发现配置，用于批量且自动地接入 Kubernetes 上的监控点。

- 服务名称（Service Name）

    服务名称是服务 Service 唯一的名字，是 Service 在服务网格里的唯一标识。服务名称是唯一的，不得重复。一个服务有多个版本，但是服务名是与版本独立的。

- 服务条目（Service Entry）

    服务条目用于将一个无法注册到服务注册表的网格内部服务（例如：vm）或网格外部服务器添加到服务网格抽象模型中。添加服务条目后，Envoy 代理可以将流量发送到该服务，这个服务条目将和网格中的其他服务一样。

- 服务网格（Service Mesh）

    服务网格是一个可管理、可观测以及支持工作负载实例之间进行安全通信的基础设施层。在一个网格中，服务名称与命名空间组合具有唯一性。
    例如，在一个多集群的网格中，cluster-1 集群的 foo 命名空间中的 bar 服务和 cluster-2 集群的 foo 命名空间中的 bar 服务被认为是同一个服务。

    由于服务网格会共享这种标识，因此同一服务网格内的工作负载实例可以相互认证通信。

- 服务注册表（Service Registry）

    服务网格维护了一个内部服务注册表 (service registry)，包含在服务网格中运行的一组服务及其相应的服务 endpoints。服务网格使用服务注册表生成 Envoy 配置。

- 告警规则

    基于资源状态创建告警对象，自定义触发规则的条件以及通过何种方式发送通知的规则。

- 工作负载（Workload）

    工作负载是 operators 部署的二进制文件，用于提供服务网格应用的一些功能。工作负载有自己的名称、命名空间和唯一的 ID。这些属性可以通过下面的属性被策略配置和遥测配置使用：

    - source.workload.name, source.workload.namespace, source.workload.uid
    - destination.workload.name, destination.workload.namespace, destination.workload.uid

- 工作负载实例（Workload Instance）

    工作负载实例是工作负载的一个二进制实例化对象。一个工作负载实例可以开放零个或多个服务 endpoint， 也可以消费零个或多个服务。工作负载实例具有许多属性：名称和命名空间、IP 地址、唯一的 ID、标签、主体等

- 工作负载实例主体（Workload Instance Principal）

    工作负载实例主体是工作负载实例的可验证权限。服务网格的服务到服务身份验证用于生成工作负载实例主体。默认情况下，工作负载实例主体与 SPIFFE ID 格式兼容。

- 工作空间 (Workspace)

    工作空间是一种资源范畴，代表一种资源层级关系。工作空间可以包含集群、命名空间、注册中心等资源。通常一个工作空间对应一个项目，可以为每个工作空间分配不同的资源，指派不同的用户和用户组。

- 工作集群（Worker Cluster）

    工作集群是一个连接到集群外部控制平面的集群。工作集群可以连接到主集群的控制平面，或连接到一个外部控制平面。

- Grafana

    Grafana 是一个开源的可视化平台，提供了多样的监控数据可视化面板。

- Group

    Nacos 中的一组配置集。

- 滚动更新

    滚动更新指一次只更新一小部分副本，成功后再更新更多的副本，最终完成所有副本的更新。滚动更新的最大的好处是零停机，整个更新过程始终有副本在运行，从而保证业务的连续性。

- 汇总（Summary）

    类似于直方图，汇总也对观察结果进行采样。除了可以统计采样值总和和总数，它还能够按分位数统计。有以下几种方式来产生汇总（假设度量指标为 `<basename>`）：

    - 按分位数，也就是采样值小于该分位数的个数占总数的比例小于 φ，相当于 `<basename>{quantile="<φ>"}`
    - 采样值总和，相当于 `<basename>_sum`
    - 采样值总数，相当于 `<basename>_count`

- 计量器（Gauge）

    计量器是一个 **既可增又可减** 的度量指标值。计量器主要用于测量类似于温度、内存使用量这样的瞬时数据。

- 集群（CLUSTER）

    集群是运行容器化应用程序的一组计算节点。 通常，组成集群的计算节点彼此可以直接连接。集群通过规则或策略限制外部访问。

- 计数器（Counter）

    计数器是一种累计型的度量指标，它是一个 **只能递增** 的数值。计数器主要用于统计类似于服务请求数、任务完成数和错误出现次数这样的数据。

- 控制平面（Control Plane）

    控制平面是一组系统服务，这些服务配置网格或者网格的子网来管理工作负载实例之间的通信。单个网格中控制平面的所有实例共享相同的配置资源。

- 链路

    记录单次请求范围内的处理信息，其中包括服务调用和处理时长等数据。一个 Trace 有一个唯一的 Trace ID ，并由多个 Span 组成。

- 临时微服务实例

    不能持久化存储在 Nacos 服务端的微服务实例。临时微服务实例需要通过上报心跳的方式进行包活，如果一段时间内没有上报心跳，就会被 Nacos 服务端摘除。

- 路由规则（Routing Rule）

    在虚拟服务中配置的路由规则，遵循服务网格定义了请求的路径。使用路由规则，可以定义将寻址到虚拟服务主机的流量路由到指定目标的工作负载。路由规则使您可以控制流量，以实现按百分比分配流量的分阶段等任务。

- 命名空间（微服务治理模块）

    在微服务引擎中，命名空间指的是 Nacos 命名空间，主要用于实现租户层级的配置隔离，例如隔离开发环境、测试环境、生产环境的资源配置。

- 目标

    Prometheus 抓取的采集目标。采集目标暴露自身状态，或者代理暴露监控对象的运行、业务指标。

- 目标服务（Destination）

    目标服务是 envoy 代表一个源服务工作负载与之打交道的远程上游服务。这些上游服务可以有多个服务版本，envoy 根据路由选择对应的版本。

- 目标规则（Destination Rule）

    目标规则定义了在路由发生后应用于服务的流量策略。这些规则指定负载均衡的配置、来自边车代理的连接池大小以及异常检测设置，从而实现从负载均衡池中检测和熔断不健康的主机。

- Nacos 集群节点角色

    节点在 Raft 协议中的角色。Raft 是一种实现分布式共识的协议，即如何让多个节点达成一致。**Leader** 是所有请求的处理者，负责接收客户端发起的操作请求，将请求写入本地日志并向其他节点同步请求日志。任何时候最多只能有一个 Leader。**Follower** 是 Leader 的跟随者，负责从 Leader 接收更新请求并将其写入本地日志，并在 Leader 通知可以提交日志时提交日志。

- Operator

    Operator 是打包，部署和管理 Kubernetes 应用程序的一种方法。

- Pilot

    Pilot 是服务网格里的一个组件，它控制 Envoy 代理，负责服务发现、负载均衡和路由分发。

- Pod

    Pod 中包含了一个或多个共享存储和网络的容器（例如 Docker 容器），以及如何运行容器的规范。Pod 是服务网格的 Kubernetes 部署中的一个工作负载实例。

- Prometheus

    Prometheus是一套开源的监控、报警、时间序列数据库的组合。

- PromQL

    Prometheus 内置的数据查询语言，其提供对时间序列数据丰富的查询，聚合以及逻辑运算能力的支持。

- 全局限流

    可选择增加网关限流组件，通过限流组件可以支持更多的流量管控能力。但是，限流组件也会导致一定的资源消耗和性能损失，默认情况下不启用。请根据实际情况判断是否需要启用。

- 权重

    权重为浮点数。权重越大，表示分配给该实例的流量越大。

- 日志

    系统运行过程中变化的一种抽象数据，其内容为指定对象的操作和其操作结果按时间的有序集合。

- Service Operator

    Service Operator 是在服务网格里管理 Service 的代理，通过操纵配置状态并通过各种仪表板监视服务的运行状况来管理这些服务。

- 审计日志

    审计日志提供了对系统中对象所做更改的历史记录。

- 数据平面（Data Plane）

    数据平面是网格的一部分，直接控制工作负载实例之间的通信。服务网格的数据平面使用智能 Envoy 代理部署成边车去调节和控制服务网格中发送和接受的流量。

- 通知

    当资源存在异常而产生告警时，可将告警信息通过邮件、钉钉、企业微信、webhook等方式发送给指定的用户。

- 托管控制平面（Managed Control Plane）
  
    托管控制平面是一个为客户提供管理的控制平面。
    托管控制平面降低了用户部署的复杂性，并通常保证一定水平的性能和可用性。

- 托管网格（Managed Mesh）

    由服务网格在所选集群创建并托管的控制平面。具备简单、低成本、高可用、无需单独运维管理 的特点。

- 外部控制平面（External Control Plane）
  
     外部控制平面可以从外部管理运行在自己的集群或者其他基础设施中的网格工作负载。控制屏幕可以部署在一个集群中，但是不能部署在它所控制的网格的一部分 集群中。它的目的是将控制平面与网格的数据屏幕完全分离。

- 网关工作节点

    工作节点主要运行 Envoy 开源应用，主要提供高性能的反向代理能力，支持负载均衡、路由、缓存、自定义路由等功能。工作节点的数量和性能将直接影响网关的性能，建议根据需要部署足够的工作节点。

- 网关规则（Gateway）

    网关规则（Gateway）定义了在网格南北向连接操作的负载均衡器，用于建立入站和出站的 HTTP/TCP 访问连接。
    它描述了需要公开的一组端口、服务域名、协议类型、负载均衡器的 SNI 配置等信息。

- 网关控制节点

    Contour 作为微服务网关的控制面，被部署为控制节点，充当 Envoy 的后端管理服务能力。Contour 提供便捷的网关配置，支持动态配置更新，多集群部署能力。Contour 同时提供了 HTTPProxy CRD 用于增强 Kubernetes Ingress 的核心配置能力，Contour 以 Deployment 的方式部署，为保障生产服务稳定性，建议部署在多个副本。

- 微服务

    微服务是一种通过多个小型服务组合来构建单个应用的架构风格。在微服务引擎中，微服务指将一个完整的应用根据业务功能拆分而得到的各个小型服务。

- 微服务实例

    将同一个微服务部署在多个容器或虚拟机上，每个容器或虚拟机上运行的微服务副本就是一个微服务实例。多个微服务实例可以同时运行。

- 微服务实例分组

    将同一个微服务下的所有微服务实例按照需求进一步划分得到的分组。

- 心跳

    实例启动后每隔一段时间，内置的 Nacos 客户端会主动向 Nacos 服务器发起心跳包（HeartBeat），表示实例仍存活，避免被服务端剔除。心跳包包含当前服务实例的名称、IP、端口、集群名称、权重等信息。

- 虚拟服务（Virtual Service）

    虚拟服务定义了一系列针对指定服务的流量路由规则。每个路由规则都针对特定协议定义流量匹配规则。如果流量符合这些特征，就会根据规则发送到服务注册表中的目标服务（或者目标服务的子集或版本）。

- 依赖拓扑

    以拓扑图的方式展示服务调用之间的依赖关系。

- 元数据

    元数据是数据本身的描述信息，是关于数据的数据，例如服务版本、各种自定义标签等。元数据分为服务级别的元数据、集群的元数据及实例的元数据。

- 资源请求值

    请求值规定了为实例预先分配多少可用资源。

- 资源限制值

    限制值是实例的可用资源上限。请求值小于限制值。

- 诊断模式

    诊断模式即对 Contour 进行功能调试，支持在 Contour 启动时附加对应的启动参数。

- 直方图（Histogram）

    直方图对观察结果（通常是请求持续时间或者响应大小这样的数据）进行采样，并在可配置的桶中对其进行统计。有以下几种方式来产生直方图（假设度量指标为 `<basename>`）：

    - 按桶计数，相当于 `<basename>_bucket{le="<upper inclusive bound>"}`
    - 采样值总和，相当于`<basename>_sum`
    - 采样值总数，相当于 `<basename>_count` ，也等同于把所有采样值放到一个桶里来计数 `<basename>_bucket{le="+Inf"}`

    Histogram 可以理解为柱状图，典型的应用如：请求持续时间，响应大小。可以对观察结果采样，分组及统计。

- 指标

    对资源性能的数据描述或状态描述，指标由命名空间、维度、指标名称和单位组成。采集目标暴露的、可以完整反映监控对象运行或者业务状态的一系列标签化数据。

- 注册中心

    注册中心相当于微服务架构中的“通讯录”，负责记录服务和服务地址的映射关系。微服务引擎支持的注册中心类型有：Eureka、Zookeeper、Nacos、Mesh、Kubernetes。

- 主集群（Control Cluster）

    主集群是具有控制平面的集群。
    一个网格可以有一个以上的主集群，以用于 HA 或需要低延迟的场景。主集群可以充当工作集群的控制平面。
